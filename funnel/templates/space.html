{% extends "layout.html" %}
{% block title %}{{ space.title }}{% endblock %}

{%- macro proposal_table(proposals) %}
  <div class="table-responsive">
    <table class="table table-bordered listing">
      <thead>
        <tr>
          <th class="num">#</th>
          <th>{% trans %}Proposer{% endtrans %}</th>
          <th>{% trans %}Speaker{% endtrans %}</th>
          <th>{% trans %}Section{% endtrans %}</th>
          <th>{% trans %}Type{% endtrans %}</th>
          <th>{% trans %}Level{% endtrans %}</th>
          <th class="num">{% trans %}+1{% endtrans %}</th>
          <th class="num">{% trans %}Comments{% endtrans %}</th>
          <th>{% trans %}Submitted{% endtrans %}</th>
        </tr>
      </thead>
      {% for proposal in proposals %}
        <tbody class="link">
          {%- set link=proposal.url_for() -%}
          <tr>
            <td class="num"><a href="{{ link }}">{{ loop.index }}</a></td>
            <td colspan="8"><a href="{{ link }}"><strong>{{ proposal.title }}</strong></a></td>
          </tr>
          <tr>
            <td></td>
            <td><a href="{{ link }}">{{ proposal.user.fullname }}</a></td>
            <td><a href="{{ link }}">
              {%- if proposal.speaker -%}
                {{ proposal.speaker.fullname }}
              {%- else -%}
                <em>{% trans %}(open){% endtrans %}</em>
              {%- endif -%}
            </a></td>
            <td><a href="{{ link }}">{{ proposal.section.title }}</a></td>
            <td><a href="{{ link }}">{{ proposal.session_type }}</a></td>
            <td><a href="{{ link }}">{{ proposal.technical_level }}</a></td>
            <td class="num"><a href="{{ link }}">{{ proposal.votes.count }}</a></td>
            <td class="num"><a href="{{ link }}">{{ proposal.comments.count }}</a></td>
            <td><a href="{{ link }}">{{ proposal.created_at.strftime("%a, %b %e") }}</a></td>
          </tr>
        </tbody>
      {% else %}
        <tbody>
          <tr>
            <td colspan="9">
              <em>{% trans %}(No sessions have been submitted){% endtrans %}</em>
            </td>
          </tr>
        </tbody>
      {% endfor %}
    </table>
  </div><!-- /.table-responsive -->
  <hr>
{%- endmacro %}

{% block content %}
<p>
  {{ space.datelocation }}
</p>

{{ description }}

<p>
  <strong>Status:
    {% if space.status == 0 -%}
      {% trans %}Draft{% endtrans %}
    {%- elif space.status == 1 -%}
      {% trans %}Accepting submissions{% endtrans %}
    {%- elif space.status == 2 -%}
      {% trans %}Accepting votes{% endtrans %}
    {%- elif space.status == 3 -%}
      {% trans %}Submissions and voting closed, awaiting jury selection{% endtrans %}
    {%- elif space.status == 4 -%}
      {% trans %}Open for post-event feedback{% endtrans %}
    {%- elif space.status == 5 -%}
      {% trans %}Closed{% endtrans %}
    {%- elif space.status == 6 -%}
      {% trans %}Rejected{% endtrans %}
    {%- endif -%}
  </strong>
</p>
{% if sections -%}
  <h2 id="sections">{% trans %}Sections{% endtrans %}</h2>
  <ol>
    {% for section in sections -%}
      <li>{{ section.title }} &mdash; {{ section.description }}</li>
    {% endfor -%}
  </ol>
{%- endif %}
<h2 id="sessions">{% trans %}Session proposals{% endtrans %}</h2>
{% if space.status == 1 -%}
<p>
  <a class="btn btn-primary" href="{{ space.url_for('new-proposal') }}">{% trans %}Propose a session{% endtrans %}</a>
</p>
{% endif %}
{%- if confirmed %}
  <h3>{% trans %}Confirmed sessions{% endtrans %}</h3>
  {{ proposal_table(confirmed) }}
{%- endif %}
{%- if unconfirmed %}
  {%- if confirmed %}<h3>{% trans %}Unconfirmed proposals{% endtrans %}</h3>{% endif %}
  {{ proposal_table(unconfirmed) }}
{%- endif %}
{% endblock %}
